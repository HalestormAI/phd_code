function A = line_intersect3( V_1, V_2, X_1, X_2 )

% t_1 * V_1 + x_1 = t_2 * V_2 + x_2

%t_2 = ( V_1(2)*X_2(1) - V_1(2)*X_1(1) - V_1(1)*X_2(2) - V_1(1)*X_1(2) ) / ( V_1(1)*V_2(2) - V_1(2)*V_2(1) )
%t_1 = ( t_2*V_2(1) + X_2(1) - X_1(1) ) / V_1(1)

t_1 = (V_2(2) * X_1(1) - V_2(2) * X_2(1) + X_2(2) * V_2(1) - X_1(2) * V_2(1)) / (V_2(1) * V_1(2) - V_2(2) * V_1(1));
t_2 = (V_1(1) * X_2(2) - V_1(1) * X_1(2) + X_1(1) * V_1(2) - X_2(1) * V_1(2)) / (V_2(1) * V_1(2) - V_2(2) * V_1(1));

A1 = V_1 .* t_1 + X_1;
A2 = V_2 .* t_2 + X_2;

A = mean([A1,A2],2);